✅ Чек-лист (продолжение)
3) Live-режим без дублей и утечек

 Один ключ = один стрим: chatId:type:symbol:tf не создаёт второй WS/подписку при обновлении страницы/рефреше.

 Стоп стратегии реально отписывает: при toggle OFF закрываются KLINE+AGGTRADE, удаляется ключ из sockets, чистится подписка в MarketDataStreamService.

 Reconnect: если Binance WS упал — автоматом переподключается (с backoff) и UI не “висит”.

 Heartbeat/health: раз в N секунд лог/метрика “сколько активных сокетов/подписок”.

4) Синхронизация настроек (UI ↔ backend ↔ chart)

 При смене symbol/timeframe/limit:

 сохраняется в settings,

 фронт перезапускает подписку,

 бек отписывается от старого ключа и подписывается на новый,

 график делает setData() снапшотом и дальше принимает live.

 URL всегда содержит контекст (chatId/exchange/network/symbol/tf/limit) и после F5 всё корректно восстанавливается.

5) UX дашборда (то, что просил раньше)

 Кнопка “на весь экран” для блока графика (fullscreen API).

 Кнопка “сохранить”:

вариант А: сохранить PNG (через canvas/renderer),

вариант Б: сохранить текущие настройки (symbol/tf/limit + чекбоксы) одним кликом.

 Индикатор состояния: WS ONLINE/OFFLINE, STREAM OK, последняя свеча ts.

6) Логи без спама (после того как всё ожило)

 onPriceUpdate перевести в DEBUG или логировать раз в N секунд/по событию (например, сигнал/сделка).

 В INFO оставить только: старт/стоп, connect/disconnect, ошибка/реконнект, сделка/ордер.

7) Торговая часть (минимальный “боевой” цикл)

 У стратегии есть понятный цикл:

сигнал → расчёт объёма → placeOrder → TP/SL → запись в историю.

 История сделок/ордеров отображается на дашборде и рисуется на графике.

 Защита от повторного входа, если уже в позиции.
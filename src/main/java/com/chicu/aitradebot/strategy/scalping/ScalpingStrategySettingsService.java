package com.chicu.aitradebot.strategy.scalping;

import com.chicu.aitradebot.strategy.core.SettingsSnapshot;

/**
 * –°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç—ã —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —Å–∫–∞–ª—å–ø–∏–Ω–≥–æ–≤–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ chatId.
 *
 * üîí –ö–õ–Æ–ß–ï–í–û–ï –ü–†–ê–í–ò–õ–û:
 * - UI / Telegram –æ–±–Ω–æ–≤–ª—è—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¢–û–õ–¨–ö–û –ß–ê–°–¢–ò–ß–ù–û (–ø–æ TAB-–∞–º)
 * - –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û —Å immutable snapshot
 * - –ù–∏–∫–∞–∫–æ–≥–æ "—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å—ë –∏–∑ —Ñ–æ—Ä–º—ã"
 */
public interface ScalpingStrategySettingsService {

    // =====================================================
    // JPA / UI / TELEGRAM
    // =====================================================

    /**
     * –ù–∞–π—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ chatId –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ, –µ—Å–ª–∏ –∑–∞–ø–∏—Å–∏ –µ—â—ë –Ω–µ—Ç.
     * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è UI, Telegram –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π.
     */
    ScalpingStrategySettings getOrCreate(Long chatId);

    /**
     * –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏.
     *
     * ‚ö†Ô∏è –ù–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ UI.
     * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–∞ –ø–æ—Å–ª–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ update.
     */
    ScalpingStrategySettings save(ScalpingStrategySettings settings);

    /**
     * –ß–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫.
     *
     * ‚ùó dto —Å–æ–¥–µ—Ä–∂–∏—Ç –¢–û–õ–¨–ö–û –ø–æ–ª—è –æ–¥–Ω–æ–≥–æ TAB-–∞
     * ‚ùó null-–ø–æ–ª—è –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è (–Ω–µ –∑–∞—Ç–∏—Ä–∞—é—Ç –¥–∞–Ω–Ω—ã–µ)
     * ‚ùó —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ
     *
     * –ü—Ä–∏–º–µ—Ä:
     * - Trade TAB ‚Üí symbol, timeframe, cachedCandlesLimit
     * - Risk TAB  ‚Üí stopLossPct, takeProfitPct, riskPerTradePct
     */
    ScalpingStrategySettings update(Long chatId, ScalpingStrategySettings dto);

    // =====================================================
    // V4 STRATEGY RUNTIME
    // =====================================================

    /**
     * Immutable snapshot –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–ª—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.
     *
     * ‚ùó –ù–ï JPA
     * ‚ùó –ù–ï mutable
     * ‚ùó –ë–ï–ó EntityManager
     * ‚ùó –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¢–û–õ–¨–ö–û —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π –≤–æ –≤—Ä–µ–º—è —Ç–æ—Ä–≥–æ–≤–ª–∏
     */
    SettingsSnapshot getSnapshot(long chatId);
}

<!doctype html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<body>

<div th:fragment="content">

    <h2 class="fw-bold mb-4 d-flex align-items-center gap-2">
        <i class="bi bi-diagram-3"></i>
        <span>–°—Ç—Ä–∞—Ç–µ–≥–∏–∏</span>
    </h2>

    <div class="row g-4">

        <!-- –û–î–ù–ê –ö–ê–†–¢–û–ß–ö–ê –ù–ê –°–¢–†–ê–¢–ï–ì–ò–Æ -->
        <div class="col-md-4 col-sm-6" th:each="s : ${strategies}">

            <div class="card card-theme strategy-card h-100 shadow-sm"
                 th:classappend="${s.active} ? ' border-success border-2' : ''">

                <div class="card-body text-center">

                    <!-- –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ -->
                    <h5 class="strategy-title mb-2" th:text="${s.title}">Strategy</h5>

                    <!-- –°—Ç–∞—Ç—É—Å -->
                    <span class="badge px-3 py-2 mb-2"
                          th:classappend="${s.active} ? ' bg-success' : ' bg-secondary'">
                        <span th:text="${s.active} ? 'üü¢ –ê–∫—Ç–∏–≤–Ω–∞' : '‚ö´ –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞'">
                            ‚ö´ –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
                        </span>
                    </span>

                    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–∞ -->
                    <div class="small text-start">
                        <div>
                            <strong>–ë–∏—Ä–∂–∞:</strong>
                            <span th:text="${s.exchangeName}">BINANCE</span>
                        </div>
                        <div>
                            <strong>–°–µ—Ç—å:</strong>
                            <span th:text="${s.networkType}">MAINNET</span>
                        </div>
                        <div>
                            <strong>–ü–∞—Ä–∞:</strong>
                            <span th:text="${s.symbol}">BTCUSDT</span>
                        </div>
                        <div>
                            <strong>–¢–∞–π–º—Ñ—Ä–µ–π–º:</strong>
                            <span th:text="${s.timeframe}">1m</span>
                        </div>
                        <div>
                            <strong>–†–µ–∂–∏–º:</strong>
                            <span th:text="${s.advancedControlMode}">MANUAL</span>
                        </div>
                        <div>
                            <strong>PnL:</strong>
                            <span th:text="${s.totalProfitPct}"
                                  th:classappend="${s.totalProfitPct >= 0} ? ' pnl-green' : ' pnl-red'">0</span>%
                        </div>
                        <div>
                            <strong>ML –¥–æ–≤–µ—Ä–∏–µ:</strong>
                            <span th:text="${s.mlConfidence}">0</span>
                        </div>
                        <div>
                            <strong>TP/SL:</strong>
                            <span th:text="${s.takeProfitPct}">1</span> /
                            <span th:text="${s.stopLossPct}">1</span>%
                        </div>
                        <div>
                            <strong>–†–∏—Å–∫/—Å–¥–µ–ª–∫—É:</strong>
                            <span th:text="${s.riskPerTradePct}">1</span>%
                        </div>
                        <div>
                            <strong>–ö–æ–º–∏—Å—Å–∏—è:</strong>
                            <span th:text="${s.commissionPct}">0.05</span>%
                        </div>
                    </div>

                    <!-- –ö–ù–û–ü–ö–ò -->
                    <div class="mt-4 d-grid gap-2">

                        <!-- üîÅ TOGGLE (FORM, –ù–ï JS) -->
                        <form method="post" th:action="@{/strategies/toggle}">

                            <input type="hidden" name="chatId" th:value="${s.chatId}">
                            <input type="hidden" name="type" th:value="${s.type}">
                            <input type="hidden" name="exchange" th:value="${s.exchangeName}">
                            <input type="hidden" name="network" th:value="${s.networkType}">
                            <input type="hidden" name="symbol" th:value="${s.symbol}">
                            <input type="hidden" name="timeframe" th:value="${s.timeframe}">
                            <button type="submit"
                                    class="btn"
                                    th:classappend="${s.active} ? ' btn-outline-danger' : ' btn-outline-success'">
                                <i th:class="${s.active} ? 'bi bi-stop-fill' : 'bi bi-play-fill'"></i>
                                <span th:text="${s.active} ? '–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å' : '–ó–∞–ø—É—Å—Ç–∏—Ç—å'">–ó–∞–ø—É—Å—Ç–∏—Ç—å</span>
                            </button>
                        </form>

                        <!-- üìä –î–∞—à–±–æ—Ä–¥ -->
                        <a class="btn btn-outline-primary"
                           th:href="@{'/strategies/' + ${s.type} + '/dashboard'(
                                chatId=${s.chatId},
                                exchange=${s.exchangeName},
                                network=${s.networkType},
                                symbol=${s.symbol},
                                timeframe=${s.timeframe}
                           )}">
                            <i class="bi bi-graph-up"></i> –î–∞—à–±–æ—Ä–¥
                        </a>

                        <!-- ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
                        <a class="btn btn-outline-primary"
                           th:href="@{'/strategies/' + ${s.type} + '/config'(
                                chatId=${s.chatId},
                                exchange=${s.exchangeName},
                                network=${s.networkType}
                           )}">
                            <i class="bi bi-gear"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                        </a>

                    </div>

                </div>
            </div>

        </div>

    </div>

</div>

</body>
</html>
